{
	"$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
        "cosmosDbAccountId": {
            "type": "String"
        },
        "cosmosDbAccountName": {
            "type": "String"
        },
        "cosmosDbName": {
            "type": "String"
        },
        "cosmosContainerName": {
            "type": "String"
        },
		"fxPrincipalId": {
			"type": "String"
		}
    },
	"resources": [
		{
			"type": "Microsoft.DocumentDB/databaseAccounts/sqlRoleDefinitions",
			"apiVersion": "2021-04-15",
			"name": "[concat(parameters('cosmosDbAccountName'), '/4353444F-494C-4E45-5400-000000000001')]",
			"properties": {
				"roleName": "DihOdsClientFxRole",
				"type": "CustomRole",
				"permissions": [{
					"dataActions": [
						"Microsoft.DocumentDB/databaseAccounts/readMetadata",
						"Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers/items/create",
						"Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers/items/read",
						"Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers/items/upsert",
						"Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers/executeQuery",
						"Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers/readChangeFeed"
					]
				}],
				"assignableScopes": [
					"[concat(parameters('cosmosDbAccountId'), '/dbs/', parameters('cosmosDbName'), '/colls/', parameters('cosmosContainerName'))]",
					"[concat(parameters('cosmosDbAccountId'), '/dbs/', parameters('cosmosDbName'), '/colls/', parameters('cosmosContainerName'), 'Leases')]"
				]
			}
		},
		{
			"type": "Microsoft.DocumentDB/databaseAccounts/sqlRoleAssignments",
			"apiVersion": "2021-04-15",
			"name": "fx-poc/5861db81-48e9-41e3-89c6-8c4101c46821",
			"properties": {
				"roleDefinitionId": "/subscriptions/5873dc21-d366-4ca4-a7ab-361a370893e3/resourceGroups/AzureFx-CosmosDB-PoC/providers/Microsoft.DocumentDB/databaseAccounts/fx-poc/sqlRoleDefinitions/4353444f-494c-4e45-5400-000000000001",
				"principalId": "[parameters('fxPrincipalId')]",
				"scope": "/subscriptions/5873dc21-d366-4ca4-a7ab-361a370893e3/resourceGroups/AzureFx-CosmosDB-PoC/providers/Microsoft.DocumentDB/databaseAccounts/fx-poc/dbs/fx-poc-db/colls/Client"
			}
		}
	]
}